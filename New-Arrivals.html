<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>New Arrivals</title>
    <link rel="stylesheet" href="styles.css"><!-- Link your CSS file -->
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
    <style>
        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #f8fafc 0%, #e3e9f3 40%, #f7d9e3 80%, #c3e0f7 100%);
            background-attachment: fixed;
            animation: bgMove 18s ease-in-out infinite alternate;
        }
        @keyframes bgMove {
            0% {background-position: 0% 50%;}
            50% {background-position: 100% 50%;}
            100% {background-position: 0% 50%;}
        }
        .navbar, .footer-modern {
            background: linear-gradient(to right, #1a1a1a, #2c3e50) !important;
            color: #fff;
        }
        .navbar .nav-link, .navbar .navbar-brand, .navbar .btn {
            color: #fff !important;
        }
        .navbar .nav-link.active, .navbar .nav-link:focus, .navbar .nav-link:hover {
            color: #ffd700 !important;
        }
        .hero {
            background: linear-gradient(120deg, #2c3e50 0%, #1a1a1a 100%);
            color: #fff;
            padding: 100px 0 80px 0;
            text-align: center;
            border-radius: 0 0 30px 30px;
            margin-bottom: 40px;
            box-shadow: 0 8px 32px rgba(44,62,80,0.15);
            position: relative;
            overflow: hidden;
        }
        .hero::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(270deg, #2c3e50, #1a1a1a, #2c3e50, #1a1a1a);
            background-size: 400% 400%;
            opacity: 0.5;
            z-index: 0;
            animation: gradientMove 8s ease-in-out infinite;
        }
        @keyframes gradientMove {
            0% {background-position: 0% 50%;}
            50% {background-position: 100% 50%;}
            100% {background-position: 0% 50%;}
        }
        .hero .container {
            position: relative;
            z-index: 1;
        }
        .hero h1 {
            font-size: 3.5rem;
            font-weight: 800;
            letter-spacing: 2px;
            animation: fadeInDown 1.2s cubic-bezier(.77,0,.18,1) both;
        }
        .hero p {
            font-size: 1.5rem;
            color: #e0e0e0;
            margin-bottom: 2rem;
            animation: fadeInUp 1.5s cubic-bezier(.77,0,.18,1) 0.5s both;
        }
        @keyframes fadeInDown {
            0% {opacity:0; transform:translateY(-40px);}
            100% {opacity:1; transform:translateY(0);}
        }
        @keyframes fadeInUp {
            0% {opacity:0; transform:translateY(40px);}
            100% {opacity:1; transform:translateY(0);}
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-light" style="background: linear-gradient(to right, #1a1a1a, #2c3e50); color: #fff;">
        <div class="container px-4 px-lg-5">
            <a class="navbar-brand fw-bold" style="color:#fff;" href="index.html">SpringCart</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0 ms-lg-4">
                    <li class="nav-item"><a class="nav-link" style="color:#fff;" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" style="color:#fff;" href="About.html">About</a></li>
                    <li class="nav-item"><a class="nav-link active" style="color:#ffd700;" href="New-Arrivals.html">New Arrivals</a></li>
                    <li class="nav-item"><a class="nav-link" style="color:#fff;" href="add-product.html">Add Product</a></li>
                </ul>
                <!-- Cart Button -->
                <a class="btn btn-outline-dark" href="Cart.html">
                    <i class="bi-cart-fill me-1"></i>
                    Cart
                    <span class="badge bg-dark text-white ms-1 rounded-pill" id="cart-badge">0</span>
                </a>
                <!-- Auth/User Profile -->
                <div id="authContainer" class="d-flex align-items-center ms-2">
                    <a href="/oauth2/authorization/google" id="signInButton" class="btn btn-gradient-signin d-flex align-items-center" style="padding: 0.5rem 1.2rem; font-weight: 600; border-radius: 2rem; background: linear-gradient(90deg, #ff9800 0%, #ff5722 100%); color: #fff; box-shadow: 0 2px 8px rgba(255,152,0,0.15); border: none; transition: background 0.3s, box-shadow 0.3s;">
                        <i class="bi bi-box-arrow-in-right me-2"></i> Sign In
                    </a>
                    <div id="userProfile" class="d-none">
                        <div class="d-flex align-items-center">
                            <img id="userImage" src="" alt="Profile" class="rounded-circle me-2" style="width: 40px; height: 40px; object-fit: cover;">
                            <div class="d-flex flex-column">
                                <span id="userName" class="fw-bold text-white" style="font-size: 0.9rem;"></span>
                                <a href="http://localhost:8080/logout" class="text-white-50" style="font-size: 0.8rem; text-decoration: none;">Logout</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>
    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h1 class="display-4 fw-bolder mb-3">New Arrivals</h1>
            <p class="lead fs-5 text-white-50">Discover the latest products in our collection!</p>
            <a href="#products" class="btn btn-primary btn-lg mt-3">Browse New Arrivals</a>
        </div>
    </section>
    <section class="py-5" id="products">
        <div class="container px-4 px-lg-5 mt-5">
            <h2 class="text-center fw-bolder mb-5" id="productsTitle">New Arrivals</h2>
            <div class="row gx-4 gx-lg-5 row-cols-2 row-cols-md-3 row-cols-xl-4 justify-content-center product-grid" id="productGrid">
                <!-- Dynamic products will be inserted here -->
            </div>
        </div>
    </section>
    <!-- Footer Modern -->
    <footer class="footer-modern">
        <div class="container">
            <div class="row">
                <div class="col-md-6 mb-3 mb-md-0">
                    <h5>About SpringCart</h5>
                    <p class="mb-1">Your one-stop shop for all things trendy and essential. We bring you the best products at unbeatable prices.</p>
                </div>
                <div class="col-md-3 mb-2 mb-md-0">
                    <h6>Quick Links</h6>
                    <ul class="list-unstyled">
                        <li><a href="index.html">Home</a></li>
                        <li><a href="New-Arrivals.html">New Arrivals</a></li>
                        <li><a href="About.html">About</a></li>
                        <li><a href="add-product.html">Add Product</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h6>Contact</h6>
                    <p class="mb-1">Email: debangshubhattacharya4@gmail.com</p>
                    <p>Phone: +91 12345 67890</p>
                </div>
            </div>
            <hr style="background:rgba(255,255,255,0.2);">
            <p class="m-0 text-center">&copy; SpringCart 2025. All rights reserved.</p>
        </div>
    </footer>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Login Status Notification Script -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const signInButton = document.getElementById('signInButton');
        const userProfile = document.getElementById('userProfile');
        const userImage = document.getElementById('userImage');
        const userName = document.getElementById('userName');

        // Check login status
        fetch('http://localhost:8080/api/auth/status', {
            credentials: 'include'
        })
        .then(response => response.json())
        .then(data => {
            if (data.authenticated) {
                showNotification('Successfully logged in as ' + data.name, 'success');
                signInButton.classList.add('d-none');
                userProfile.classList.remove('d-none');
                userImage.src = data.imageUrl || 'https://via.placeholder.com/40';
                userName.textContent = data.name;
            } else {
                signInButton.classList.remove('d-none');
                userProfile.classList.add('d-none');
            }
        })
        .catch(error => {
            console.error('Auth check failed:', error);
            showNotification('Failed to check login status', 'error');
        });
    });

    function showNotification(message, type) {
        const notification = document.createElement('div');
        notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            background-color: ${type === 'success' ? '#4CAF50' : '#f44336'};
            z-index: 1000;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            animation: slideIn 0.5s ease-out;
        `;
        notification.textContent = message;
        document.body.appendChild(notification);

        // Add slide-in animation
        const keyframes = `
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
    `;
    const styleSheet = document.createElement("style");
    styleSheet.textContent = keyframes;
    document.head.appendChild(styleSheet);

    setTimeout(() => {
        notification.style.transition = 'all 0.5s ease-in';
        notification.style.opacity = '0';
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => notification.remove(), 500);
    }, 5000);
}
    </script>
    <!-- Cart Count Script -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        fetch('http://localhost:8080/api/cart', { credentials: 'include' })
            .then(res => {
                if (!res.ok) return [];
                return res.json();
            })
            .then items => {
                const badge = document.getElementById('cart-badge');
                if (badge && Array.isArray(items)) {
                    badge.textContent = items.length;
                }
            })
            .catch(() => {
                // On error, leave badge as 0
            });
    });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const productGrid = document.getElementById('productGrid');
            const productsTitle = document.getElementById('productsTitle');
            // Fetch only new published products from backend
            function fetchNewArrivals(url) {
                fetch(url)
                    .then(res => {
                        if (!res.ok) {
                            return res.text().then(text => {
                                throw new Error(`HTTP ${res.status}: ${text}`);
                            });
                        }
                        return res.json();
                    })
                    .then(products => {
                        productGrid.innerHTML = '';
                        if (products.length === 0) {
                            productGrid.innerHTML = '<p class="text-center">No new arrivals at the moment.</p>';
                            productsTitle.textContent = 'New Arrivals';
                            return;
                        }
                        products.forEach(p => {
                            const col = document.createElement('div');
                            col.className = 'col mb-5';
                            col.innerHTML = `
                                <div class="card h-100">
                                    <img class="card-img-top" src="http://localhost:8080/api/product/${p.id}/image" alt="${p.name}" onerror="this.src='https://dummyimage.com/450x300/dee2e6/6c757d.jpg'">
                                    <div class="card-body p-4">
                                        <div class="text-center">
                                            <h5 class="fw-bolder">${p.name}</h5>
                                            $${p.price.toFixed(2)}
                                        </div>
                                    </div>
                                    <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
                                        <div class="text-center">
                                            <a class="btn btn-primary mt-auto" href="product-details.html?id=${p.id}">View Details</a>
                                        </div>
                                    </div>
                                </div>`;
                            productGrid.appendChild(col);
                        });
                        productsTitle.textContent = 'New Arrivals';
                    })
                    .catch(e => {
                        console.error('Fetch error:', e.message);
                        productGrid.innerHTML = `<p class="text-center">Failed to load products: ${e.message}</p>`;
                    });
            }
            fetchNewArrivals('http://localhost:8080/api/New-Arrival?new=true');
        });
    </script>
</body>
</html>
